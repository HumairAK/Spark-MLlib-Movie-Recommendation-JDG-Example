version: '2'

services:
  infinispan1:
    image: jboss/infinispan-server:8.2.3.Final
    container_name: ispn-1
  sparkMaster:
    image: gustavonalle/spark:2.0.0
    container_name: sparkMaster
    volumes:
      - ./recommend-mllib/target:/usr/local/code
      - ./recommend-mllib/scripts:/usr/local/code/scripts
    links:
      - infinispan1:infinispan1
    ports:
      - "9080:9080"
      - "4040:4040"
  sparkSlave:
    image: gustavonalle/spark:2.0.0
    container_name: sparkSlave
    links:
      - sparkMaster:master
  recommend-service:
    build:
      context: ./recommend-service
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
